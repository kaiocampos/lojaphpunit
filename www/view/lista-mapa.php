<?php include "view/header.php"; ?>

<h1 class="display-4 d-flex justify-content-center pt-2 pb-0" style="color: #ff0000">
  <img style="width: 55px; height:55px; margin: 5px;" src="data:image/svg+xml;utf8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pgo8IS0tIEdlbmVyYXRvcjogQWRvYmUgSWxsdXN0cmF0b3IgMTkuMC4wLCBTVkcgRXhwb3J0IFBsdWctSW4gLiBTVkcgVmVyc2lvbjogNi4wMCBCdWlsZCAwKSAgLS0+CjxzdmcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmVyc2lvbj0iMS4xIiBpZD0iQ2FwYV8xIiB4PSIwcHgiIHk9IjBweCIgdmlld0JveD0iMCAwIDUxMS45OTkgNTExLjk5OSIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNTExLjk5OSA1MTEuOTk5OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSIgd2lkdGg9IjUxMnB4IiBoZWlnaHQ9IjUxMnB4Ij4KPGc+Cgk8cGF0aCBzdHlsZT0iZmlsbDojNDRDODY4OyIgZD0iTTUxMS44NzksNDc1LjY4NWwtNDAuMjI0LTIyMS42MTFjLTAuNDAxLTIuMjEyLTEuNzczLTQuMTI4LTMuNzM5LTUuMjIxbC0xMDEuMjQyLTU2LjMxICAgYy0xLjMxNC0wLjczMi0yLjc4Ny0xLjAyMy00LjIzNC0wLjkxMWwxOC40MTksMjM3LjYwOGwtMC42MTcsMC4yNzZsMTIxLjE2NCw1NC4zNTdjMC45ODYsMC40NDEsMi4wMzQsMC42NTksMy4wNzcsMC42NTkgICBjMS42NTEsMCwzLjI4Ny0wLjU0Myw0LjYzMi0xLjU5NkM1MTEuMzEzLDQ4MS4yMiw1MTIuMzc2LDQ3OC40MjgsNTExLjg3OSw0NzUuNjg1eiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6IzQ0Qzg2ODsiIGQ9Ik0yNTYsMjQ2LjM3NWwtMTAzLjU0NS01My45MzFjLTEuMjQxLTAuNjQ3LTIuNjE3LTAuOTExLTMuOTcyLTAuODIgICBjMC4zNTktMC4wMjIsMC43Mi0wLjAyLDEuMDc4LDAuMDA4bC0xOC40MTksMjM3LjYwOGwxMjEuNzgxLDU0LjYzNGMwLjk4MywwLjQ0LDIuMDMyLDAuNjU5LDMuMDc3LDAuNjU5bDAsMFYyNDYuMzc1eiIvPgo8L2c+CjxnPgoJPHBhdGggc3R5bGU9ImZpbGw6IzRDRTE2NjsiIGQ9Ik0xNDkuNTYsMTkxLjYzM2MtMS40NDctMC4xMTItMi45MiwwLjE3OS00LjIzNCwwLjkxbC0xMDEuMjQzLDU2LjMxICAgYy0xLjk2NiwxLjA5My0zLjMzOCwzLjAwOC0zLjczOSw1LjIyMUwwLjEyMSw0NzUuNjg1Yy0wLjQ5OCwyLjc0MiwwLjU2Niw1LjUzNCwyLjc2Myw3LjI1MmMxLjM0NywxLjA1MywyLjk4MiwxLjU5Niw0LjYzMiwxLjU5NiAgIGMxLjA0MywwLDIuMDkyLTAuMjE3LDMuMDc3LTAuNjU5bDEyMC41MDQtNTQuMDYxTDE0OS41NiwxOTEuNjMzeiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6IzRDRTE2NjsiIGQ9Ik0zNjIuNDM5LDE5MS42MjhjLTAuOTk2LDAuMDc3LTEuOTgxLDAuMzQyLTIuODk0LDAuODE4TDI1NiwyNDYuMzc2djIzOC4xNThjMCwwLDAsMCwwLjAwMSwwICAgYzEuMDQ1LDAsMi4wOTUtMC4yMTgsMy4wNzctMC42NTlsMTIxLjc4MS01NC42MzRMMzYyLjQzOSwxOTEuNjI4eiIvPgo8L2c+Cjxwb2x5Z29uIHN0eWxlPSJmaWxsOiNGRkRCNTY7IiBwb2ludHM9IjI4LjE1NCwzMjEuMjMzIDE5Ljk4MywzNjYuMjUyIDE0MC45NzcsMzAyLjM0NiAxNDMuNzg2LDI2Ni4xMDcgMTQ0LjI1MiwyNjAuMDk3ICIvPgo8cGF0aCBzdHlsZT0iZmlsbDojQThFRUZDOyIgZD0iTTE0Mi4wNjYsMjg4LjI5NGwtMS4wODksMTQuMDUyTDE5Ljk4MywzNjYuMjUyTDAuMTIxLDQ3NS42ODVjLTAuNDk4LDIuNzQyLDAuNTY2LDUuNTM0LDIuNzYzLDcuMjUyICBjMS4zNDcsMS4wNTMsMi45ODIsMS41OTYsNC42MzIsMS41OTZjMS4wNDMsMCwyLjA5Mi0wLjIxNywzLjA3Ny0wLjY1OWwxMjAuNTA0LTU0LjA2MUwxNDIuMDY2LDI4OC4yOTRMMTQyLjA2NiwyODguMjk0eiIvPgo8Zz4KCTxwb2x5Z29uIHN0eWxlPSJmaWxsOiNGRkJCMjQ7IiBwb2ludHM9IjI1Ni4wMywyNzYuMDggMTQ0LjI1MiwyNjAuMDk3IDE0MC45NzcsMzAyLjM0NiAyNTYsNDc3LjAyNSAyNTYsNDEzLjUwNyAxODcuMzYzLDMwNS40MjkgICAgMjU2LjAzLDMxMy42NDIgICIvPgoJPHBvbHlnb24gc3R5bGU9ImZpbGw6I0ZGQkIyNDsiIHBvaW50cz0iNDU5Ljk0NiwyNDQuNDIxIDQxMS4zMTEsMjE3LjM3IDM2NS4yNjksMjI4LjEyOCAzNjUuODQ1LDIzNS41NjQgMzY4LjExOSwyNjQuODk4ICAiLz4KPC9nPgo8cG9seWdvbiBzdHlsZT0iZmlsbDojRkZEQjU2OyIgcG9pbnRzPSIzNzIuMjAyLDMxNy41NzYgMzY3Ljg0MiwyNjEuMzI3IDM2Ny44NDIsMjYxLjMyNyAzNjUuMjY5LDIyOC4xMjggMjU2LjAzLDI3Ni4wOCAgIDI1Ni4wMywzMTMuNjQyIDMyNy4zODYsMjgyLjYxMiAiLz4KPHBhdGggc3R5bGU9ImZpbGw6I0ZGQkIyNDsiIGQ9Ik01MTEuODc5LDQ3NS42ODVsLTEwLjEwMy01NS42NjZMMzY4LjExOSwyNjQuODk4bDQuMDg0LDUyLjY3OGwxMzcuMDcsMTY1LjIyMSAgQzUxMS4zNTcsNDgxLjA3LDUxMi4zNjQsNDc4LjM1OCw1MTEuODc5LDQ3NS42ODV6Ii8+CjxwYXRoIHN0eWxlPSJmaWxsOiNGRjRBNEE7IiBkPSJNMjU2LjQ4MSwyNy40NjVjLTU3Ljk2MywwLTEwNS4xMiw0Ny4xMTgtMTA1LjEyLDEwNS4wMzRjMCwzNS44MjYsMTcuMDA5LDc0LjI5LDUwLjU1NiwxMTQuMzIyICBjMjQuNjM5LDI5LjQwMyw0OC45NDMsNDguMzE0LDQ5Ljk2Niw0OS4xMDVjMS4zNTQsMS4wNDcsMi45NzYsMS41Nyw0LjU5OSwxLjU3YzEuNjIyLDAsMy4yNDUtMC41MjMsNC41OTktMS41NyAgYzEuMDIyLTAuNzkxLDI1LjMyNy0xOS43MDIsNDkuOTY2LTQ5LjEwNWMzMy41NDctNDAuMDMyLDUwLjU1Ni03OC40OTUsNTAuNTU2LTExNC4zMjIgIEMzNjEuNjAxLDc0LjU4MywzMTQuNDQ0LDI3LjQ2NSwyNTYuNDgxLDI3LjQ2NXogTTI5NS40MTEsMTMyLjQ5OGMwLDIxLjQ4Mi0xNy40MywzOC44OTgtMzguOTMsMzguODk4ICBjLTIxLjUsMC0zOC45My0xNy40MTUtMzguOTMtMzguODk4czE3LjQzLTM4Ljg5OCwzOC45My0zOC44OThDMjc3Ljk4MSw5My42LDI5NS40MTEsMTExLjAxNiwyOTUuNDExLDEzMi40OTh6Ii8+CjxwYXRoIHN0eWxlPSJmaWxsOiNFNzM0M0Y7IiBkPSJNMjU2LjQ4MSwyNy40NjVjLTQuNTk0LDAtOS4xMTksMC4yOTgtMTMuNTU5LDAuODcyYzUxLjU4Myw2LjY2Nyw5MS41NjIsNTAuODM2LDkxLjU2MiwxMDQuMTYyICBjMCwzNS44MjYtMTcuMDA5LDc0LjI5LTUwLjU1NiwxMTQuMzIyYy0xNS44NDUsMTguOTA4LTMxLjU0LDMzLjQ2Ny00MS4wMDUsNDEuNjY5YzUuMjU0LDQuNTUyLDguNTk2LDcuMTU0LDguOTYsNy40MzYgIGMxLjM1NCwxLjA0NywyLjk3NiwxLjU3LDQuNTk5LDEuNTdjMS42MjIsMCwzLjI0NS0wLjUyMyw0LjU5OS0xLjU3YzEuMDIyLTAuNzkxLDI1LjMyNy0xOS43MDIsNDkuOTY2LTQ5LjEwNSAgYzMzLjU0Ny00MC4wMzIsNTAuNTU2LTc4LjQ5NSw1MC41NTYtMTE0LjMyMkMzNjEuNjAxLDc0LjU4MywzMTQuNDQ0LDI3LjQ2NSwyNTYuNDgxLDI3LjQ2NXoiLz4KPHBhdGggc3R5bGU9ImZpbGw6I0ZGREI1NjsiIGQ9Ik0yNTkuMDc4LDQ4My44NzRsNDUuMjg1LTIwLjMxNkwyNTYsNDEzLjUwN3Y3MS4wMjZjMCwwLDAsMCwwLjAwMSwwICBDMjU3LjA0Niw0ODQuNTMzLDI1OC4wOTUsNDg0LjMxNiwyNTkuMDc4LDQ4My44NzR6Ii8+CjxnPgoJPHBhdGggc3R5bGU9ImZpbGw6IzFFQTRFOTsiIGQ9Ik00NzEuNjU0LDI1NC4wNzRjLTAuNDAxLTIuMjEyLTEuNzczLTQuMTI4LTMuNzM5LTUuMjIxbC03Ljk3LTQuNDMzbC05MS44MjcsMjAuNDc3bDAsMCAgIGwxMzMuNjU2LDE1NS4xMjFMNDcxLjY1NCwyNTQuMDc0eiIvPgoJPHBhdGggc3R5bGU9ImZpbGw6IzFFQTRFOTsiIGQ9Ik0yNTUuOTk5LDQ4NC41MzNDMjU2LDQ4NC41MzMsMjU2LDQ4NC41MzMsMjU1Ljk5OSw0ODQuNTMzdi03LjUwOEwxNDAuOTc3LDMwMi4zNDZsLTkuODM3LDEyNi44OTUgICBsMTIxLjc4MSw1NC42MzRDMjUzLjkwNCw0ODQuMzE2LDI1NC45NTMsNDg0LjUzMywyNTUuOTk5LDQ4NC41MzN6Ii8+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPGc+CjwvZz4KPC9zdmc+Cg==" /> Locais de doação</h1>
<hr style="background-color: red; " class="w-50">
<!-- INICIO MAPBOX -->
<div class="container ">
  <div class="row">
    <div class='sidebar'>
      <div class='heading'>
        <h1>Lugares Doação</h1>
      </div>
      <div id='listings' class='listings'>

      </div>
    </div>
    <div id='map' class='map pad2'>

    <script>
      mapboxgl.accessToken = 'pk.eyJ1Ijoicm9iZXJ0by1qdW5pb3I5OSIsImEiOiJjazJuN212YTkwMXB5M2JuejI4cTQ0MTd2In0.hXajmx4S4Ev9eaeJPKeSeA';
      var map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/streets-v11',
        // initial position in [lon, lat] format
        center: [-43.593078, -22.902450],
        // initial zoom
        zoom: 14
      });
      var stores = {
        "type": "FeatureCollection",
        "features": [{
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -43.678918, -22.923656
              ]
            },
            "properties": {
              "phoneFormatted": "(202) 979956274",
              "phone": "2022347336",
              "address": "Rua Felipe Cardoso - Santa Cruz",
              "city": "Rio de Janeiro",
              "country": "Rio de Janeiro",
              "crossStreet": "at 15th St NW",
              "postalCode": "20005",
              "state": "RJ"
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -43.349345, -22.845515,
              ]
            },
            "properties": {
              "phoneFormatted": "(202) 31553075",
              "phone": "31553075",
              "address": "Rocha Miranda - Rocha Miranda",
              "city": "Rio de Janeiro",
              "country": "Brasil",
              "crossStreet": "at 22nd St NW",
              "postalCode": "20037",
              "state": "RJ."
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.043929,
                38.910525
              ]
            },
            "properties": {
              "phoneFormatted": "(202) 387-9338",
              "phone": "2023879338",
              "address": "1512 Connecticut Ave NW",
              "city": "Washington DC",
              "country": "United States",
              "crossStreet": "at Dupont Circle",
              "postalCode": "20036",
              "state": "D.C."
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.0672,
                38.90516896
              ]
            },
            "properties": {
              "phoneFormatted": "(202) 337-9338",
              "phone": "2023379338",
              "address": "3333 M St NW",
              "city": "Washington DC",
              "country": "United States",
              "crossStreet": "at 34th St NW",
              "postalCode": "20007",
              "state": "D.C."
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.002583742142,
                38.887041080933
              ]
            },
            "properties": {
              "phoneFormatted": "(202) 547-9338",
              "phone": "2025479338",
              "address": "221 Pennsylvania Ave SE",
              "city": "Washington DC",
              "country": "United States",
              "crossStreet": "btwn 2nd & 3rd Sts. SE",
              "postalCode": "20003",
              "state": "D.C."
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -76.933492720127,
                38.99225245786
              ]
            },
            "properties": {
              "address": "8204 Baltimore Ave",
              "city": "College Park",
              "country": "United States",
              "postalCode": "20740",
              "state": "MD"
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.097083330154,
                38.980979
              ]
            },
            "properties": {
              "phoneFormatted": "(301) 654-7336",
              "phone": "3016547336",
              "address": "4831 Bethesda Ave",
              "cc": "US",
              "city": "Bethesda",
              "country": "United States",
              "postalCode": "20814",
              "state": "MD"
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.359425054188,
                38.958058116661
              ]
            },
            "properties": {
              "phoneFormatted": "(571) 203-0082",
              "phone": "5712030082",
              "address": "11935 Democracy Dr",
              "city": "Reston",
              "country": "United States",
              "crossStreet": "btw Explorer & Library",
              "postalCode": "20190",
              "state": "VA"
            }
          },
          {
            "type": "Feature",
            "geometry": {
              "type": "Point",
              "coordinates": [
                -77.10853099823,
                38.880100922392
              ]
            },
            "properties": {
              "phoneFormatted": "(703) 522-2016",
              "phone": "7035222016",
              "address": "4075 Wilson Blvd",
              "city": "Arlington",
              "country": "United States",
              "crossStreet": "at N Randolph St.",
              "postalCode": "22203",
              "state": "VA"
            }
          },

        ]
      };
      map.on('load', function(e) {
        // Add the data to your map as a layer
        map.addLayer({
          id: 'locations',
          type: 'symbol',
          // Add a GeoJSON source containing place coordinates and information.
          source: {
            type: 'geojson',
            data: stores
          },
          layout: {
            'icon-image': 'hospital',
            'icon-allow-overlap': true,
          }
        });
        buildLocationList(stores);
      });
      // Add an event listener for when a user clicks on the map
      map.on('click', function(e) {
        // Query all the rendered points in the view
        var features = map.queryRenderedFeatures(e.point, {
          layers: ['locations']
        });
        if (features.length) {
          var clickedPoint = features[0];
          // 1. Fly to the point
          flyToStore(clickedPoint);
          // 2. Close all other popups and display popup for clicked store
          createPopUp(clickedPoint);
          // 3. Highlight listing in sidebar (and remove highlight for all other listings)
          var activeItem = document.getElementsByClassName('active');
          if (activeItem[0]) {
            activeItem[0].classList.remove('active');
          }
          // Find the index of the store.features that corresponds to the clickedPoint that fired the event listener
          var selectedFeature = clickedPoint.properties.address;

          for (var i = 0; i < stores.features.length; i++) {
            if (stores.features[i].properties.address === selectedFeature) {
              selectedFeatureIndex = i;
            }
          }
          // Select the correct list item using the found index and add the active class
          var listing = document.getElementById('listing-' + selectedFeatureIndex);
          listing.classList.add('active');
        }
      });

      function flyToStore(currentFeature) {
        map.flyTo({
          center: currentFeature.geometry.coordinates,
          zoom: 15
        });
      }

      function createPopUp(currentFeature) {
        var popUps = document.getElementsByClassName('mapboxgl-popup');
        // Check if there is already a popup on the map and if so, remove it
        if (popUps[0]) popUps[0].remove();

        var popup = new mapboxgl.Popup({
            closeOnClick: false
          })
          .setLngLat(currentFeature.geometry.coordinates)
          .setHTML('<h3>Hospital</h3>' +
            '<h4>' + currentFeature.properties.address + '</h4>')
          .addTo(map);
      }

      function buildLocationList(data) {
        // Iterate through the list of stores
        for (i = 0; i < data.features.length; i++) {
          var currentFeature = data.features[i];
          // Shorten data.feature.properties to `prop` so we're not
          // writing this long form over and over again.
          var prop = currentFeature.properties;
          // Select the listing container in the HTML and append a div
          // with the class 'item' for each store
          var listings = document.getElementById('listings');
          var listing = listings.appendChild(document.createElement('div'));
          listing.className = 'item';
          listing.id = 'listing-' + i;

          // Create a new link with the class 'title' for each store
          // and fill it with the store address
          var link = listing.appendChild(document.createElement('a'));
          link.href = '#';
          link.className = 'title';
          link.dataPosition = i;
          link.innerHTML = prop.address;

          // Create a new div with the class 'details' for each store
          // and fill it with the city and phone number
          var details = listing.appendChild(document.createElement('div'));
          details.innerHTML = prop.city;
          if (prop.phone) {
            details.innerHTML += ' · ' + prop.phoneFormatted;
          }
          // Add an event listener for the links in the sidebar listing
          link.addEventListener('click', function(e) {
            // Update the currentFeature to the store associated with the clicked link
            var clickedListing = data.features[this.dataPosition];
            // 1. Fly to the point associated with the clicked link
            flyToStore(clickedListing);
            // 2. Close all other popups and display popup for clicked store
            createPopUp(clickedListing);
            // 3. Highlight listing in sidebar (and remove highlight for all other listings)
            var activeItem = document.getElementsByClassName('active');
            if (activeItem[0]) {
              activeItem[0].classList.remove('active');
            }
            this.parentNode.classList.add('active');
          });
        }
      }
    </script>
    </div>
  </div>
</div>
<!-- FIM MAPBOX -->

<?php include "footer.php" ?>